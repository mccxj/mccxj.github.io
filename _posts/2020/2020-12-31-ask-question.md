---
layout: post
comments: true
title: "一次问题求助的对话记录"
description: "问题，步骤，期望结果，实际结果，这不就是我们日常的报告bug的常见模板"
categories: ["Bug反馈", "沟通"]
---

下午的时候收到一个消息，内容如下(ip采用字符代替)：

```
XX我想请教一个问题

短信网关我模拟了生产那种nfs同步的形式我在 xx.xx.xx.xx以及yy.yy.yy.yy上都部署了短信网关进程 XService，然后启动实时接口逻辑，在zz.zz上部署了一个处理进程，已经共享了一个内存给上述2机正常逻辑应该了通过日志生成个文件然后同步到zz.zz上处理移到别的地方，但是现在的情况是日志被处理移走后，在另一个目录继续收来自xx.xx个yy.yy的日志数据然后rollover再在原目录生成一个新的文件再移到新目录上继续记录我想问问这个情况是什么地方有问题导致的
```

整整一段话，我看得有点懵逼，我回复说，看不大懂，逻辑有点乱。他说过来说，我刚想说先整理整理，就看到他人已经过来了。

于是我就说看不懂，先整理整理吧，我把那段话拷贝到文本编辑器里边，边问边改。

下面是主要对话:

```
我:说了怎么多，想说什么问题？
他:有两个机写文件...然后同步到另外一个机器，这个程序处理后移走后还继续有写...
我:用nfs挂载目录，一边在写，另外一边把它移走，但还会继续写这个文件？
他:嗯
我:好几个ip写来写去，可以用A,B,C代替一下，在前面标注一下。
我:那么操作步骤是这样的？在A,B,C机器都挂载了nfs目录，在A,B部署了短信xx进程，在C部署了xx处理进程？(边说边写)，两个进程什么关系？
他:A,B机器的程序会写日志文件，C机器的程序会处理日志文件并移动到另外一个目录。
我:这不大规范呀，移动文件得保证没人写了才是正常做法。
他:我是猜测一下生产的某个报错是不是这个原因，生产是会报错，而这里还会继续写。
我:嗯，那预期情况是正常不再写？实际情况是移动到另外目录后还有数据写入，并且发生轮转后是在原目录生成新文件。
....我想了想
我:我对nfs不怎么熟悉，感觉有写入的情况移动文件，报错或者继续写入都是可预期的情况，这个得找找资料。不过轮转后文件在原目录出现应该没错的。对了，你是怎么写日志的。
他:我给你发了配置，是用log4j写日志的方式。(我瞄了一下，的确是)生产是6个机器写入文件的。
我:多个机器写同一个文件，这也不大规范吧？
他:文件是有区分区域的，正常只有一个写
我:那就没问题，不过你就不需要说A,B两个机了，说一个就可以了。
他:生产是会报错，但这里会继续写入。
我:nfs的行为还要要再看看，但是移动文件应该确保已经没有写入了。
他:这次就是改造成轮转之后再移动文件。
我:先这么处理，问题这还要再看看。
```

他就回去了，我把整理后的内容发给他，希望他下次要找求助，可以把情况描述清楚一点。

晚上的时候，突然想到，整理后的内容格式，问题，步骤，期望结果，实际结果，这不就是我们日常的报告bug的常见模板么？

世界真奇妙。